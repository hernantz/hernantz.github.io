<!DOCTYPE html>
<html lang="en">
<head>
  <title>Introducing Pak | README.txt</title>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <link rel="stylesheet" href="/theme/css/main.css" type="text/css" />
  <link rel="stylesheet" media="(max-width: 750px)" href="/theme/css/mobile.css" type="text/css" />
  <link rel="stylesheet" href="/theme/css/pygments-default.css" type="text/css" />
  <link href="/images/favicon.ico" rel="icon" type="image/x-icon" />
  <link href="/rss.xml" type="application/atom+xml" rel="alternate" title="README.txt RSS Feed" />
  <meta name="description" content="A distribution is a combination of a kernel + a package manager + a process manager. Each distribution establishes it's own policies on packaging, release cycle, filesystem layout, etc. Some package managers allow you to run scripts after installing a package. This should be done with oneshot scripts in systemd (like run …">
  <meta name="keywords" content="">
  <meta name="author" content="hernantz">
</head>

<body>

  <aside class="sidebar">
    <a href="/"><img class="rounded-img" src="/images/avatar.png" height="75" width="75" /></a>

      <nav>
        <ul>
            <li><a href="http://twitter.com/hernantz">twitter</i></a></li>
            <li><a href="http://github.com/hernantz">github</i></a></li>
            <li><a href="http://last.fm/user/hernantz">last.fm</i></a></li>
            <li><a href="/talks.html">talks</a></li>
            <li><a href="/whoami.html">whoami</a></li>
            <li><a href="/">blog</a></li>
        </ul>
      </nav>

  </aside>
  <main>
        
<article class="column-right">
  <h1 class="main-title">Introducing Pak</h1>
  <summary>
    <p class="light">
      Published
on <time datetime="2020-03-19T00:00:00-03:00">2020-03-19</time>,       under <a href="http://hernantz.github.io/category/misc.html">misc</a>.
    </p>
  </summary>
  <p>A distribution is a combination of a kernel + a package manager + a process manager.
Each distribution establishes it's own policies on packaging, release cycle, filesystem layout, etc.</p>
<p>Some package managers allow you to run scripts after installing a package. This should
be done with oneshot scripts in systemd (like run migrations for example).</p>
<p>A package manager is a program that gets a bunch of files (binaries, images, etc) from somewhere (a package) and distributes them on a filesystem (your pc for example). The manager part implies that it can keep track of installed packages, versions, etc. Packages are archives that contain files and metadata, the metadata specifies where to place the files. </p>
<p>Transactional updates: https://www.youtube.com/watch?v=ureneyH06AE</p>
<p>We need a virtualenv but for system packages. Otherwise python, rust, javascript, etc re-implement the wheel over and over.</p>
<p>Documentation should teach, not tell.
Reprocible builds come at the cost of more disk space, you need a lib which works fine with versions v0.[1-3], the user already installed v0.2 but you specified v0.1 in your dependencies, the user will get both copies installed (v0.1 and v0.2), even though only one was enough.</p>
<p>Qué pasa en Nix con paquetes que cambian de acuerdo a la arquitectura o SO -&gt; Son packetes distintos.
Cómo se hace configuración, man pages, etc en Nix, symlinks igual que con binarios?</p>
<p>https://cachix.org/
https://www.redox-os.org/news/pkgar-introduction/
https://github.com/whyrusleeping/gx</p>
<p>Packages can contain arch independent files like images or docs.
Some may include source files for building the project and testing it.</p>
<p>Qué pasa si dos librerías dependen de de una misma dependencia pero en distintas versiones, es el mismo caso que dos apps distintas dependan de distintas versiónes de una misma librería.</p>
<p>Updates de seguridad implican actualizar todo? Si, sino se pierde la build reproducible</p>
<p>https://www.youtube.com/watch?v=4ua5aeKKDzU
https://en.wikipedia.org/wiki/Package_manager
https://en.wikipedia.org/wiki/PackageKit
Pakfile -&gt; toml: contiene el listado de dependencias
Packfile.lock -&gt; contiene el graph freezado de dependencias
un clon de nix en C y sin el DSL
http://holocm.org/
https://wiki.archlinux.org/index.php/Pacman/Rosetta
https://micromind.me/en/posts/from-docker-container-to-bootable-linux-disk-image/
https://reproducible-builds.org/
https://ostree.readthedocs.io/en/latest/manual/related-projects/
https://xyrillian.de/thoughts/posts/argh-pm.html
https://www.microsoft.com/en-us/research/uploads/prod/2018/03/build-systems.pdf
https://dependabot.com/
https://nixos.org/nixos/nix-pills/
https://michael.stapelberg.ch/posts/2020-05-09-distri-hermetic-packages/</p>
<p>• unpriviliged package management
• per-user profiles (Pak profiles are package groups (bundles of packages))
• atomic updates and rollbacks
• reproducible builds (no es build tool, pero permite pinear dependencias en un Pakfile.lock)
• source-based with transparent binary downloads
https://media.libreplanet.org/u/libreplanet/m/practical-verifiable-software-freedom-with-guixsd/
What if instead of using symlinks we used images mounts? https://distr1.org/
https://getkiss.org/
https://stefanoborini.com/current-status-of-python-packaging/
https://github.com/David-OConnor/pyflow
https://sedimental.org/the_packaging_gradient.html
https://github.com/g-plane/tiny-package-manager
https://www.youtube.com/watch?v=ULqoCjANK-I
For building: https://zserge.com/posts/containers/ (Linux containers in a few lines of code)</p>
<p>Over time there has been a shift to let developers ship their apps with their
own libraries and versions. Users also enjoy having the lates features and fixes.
The problem is that since traditional package managers maintain a global state
all packages need to be curated, or users would have to embrace the dependency hell.</p>
<p>That is way containers are on the raise today.</p>
<p>They tend to solve many issues:
- Bundle your own binaries and dependencies
- Ship them as a single artifact to any distro
- To avoid duplication and save disk space, docker uses layered images. So you download ubuntu once. But many containers use different base images and you can't delete files, images only grow since they are an append only log.
- Containers also allow sandboxing, limiting cpu, memory, network and filesystem access.</p>
<p><code>pak --lock</code> should create a Pakfile.lock?</p>
<p>Maybe each <code>pak install &lt;package-name==version&gt; --lock</code></p>
<p>This uses a local <code>Pakfile</code> in the pwd, other files can be used by passing the <code>--pakfile=&lt;path-to-pakfile&gt;</code> param or <code>PAKFILE</code> environment variable.</p>
<p>All packages are installed in a store <code>/var/lib/pak/&lt;package-name-and-version&gt;/&lt;package-md5-sum&gt;/</code>.</p>
<p><code>Pakfile</code> lists dependencies and package metadata. It is better that KISS packages that have one file for each metadatum (version, sources, checksums, etc)</p>
<p><code>pak env &lt;envname&gt;</code> enters the enviroment, and sets the <code>PAKFILE</code> env to <code>/usr/share/pak/envs/envname/Pakfile</code> </p>
<p><code>pak env --list</code> lists all available envs in <code>/usr/share/pak/envs/</code></p>
<p><code>pak run &lt;commmand&gt;</code> run the command within the enviroment</p>
<p><code>pak update</code> updates all versions updating also the lock file</p>
<p><code>pak update &lt;package-name==version&gt;</code> updates only the package name, updating also the lock file</p>
<p>Sandboxing GUI apps should be done with another binary that allows to set firewalls and also allow GUI interactions to happen via portals like in flatpak (https://github.com/containers/bubblewrap). Another example would be Opensnitch.</p>
<p>Docker + docker-compose re implement a package distribution + process manager and orchestration + build system.</p>
<p>https://utcc.utoronto.ca/~cks/space/blog/linux/MicrosoftTeamsBadArrogance</p>
<p>Los packetes se pueden obtener de distintos repos/mirrors (http/ipfs/torrent/etc), that return a URI (http link, magnet link, etc) for a given key (package name)</p>
<p>Pak is a runtime environment manager.
An environment is defined in a Pakfile it might list dependencies of <code>.pak</code> files that can be pinned in a Pakfile.lock</p>
</article>

      <footer class="column-right light">
        <nav><a href="/">Home</a> - <a href="/archives.html">Archives</a> - <a href="/categories.html">Categories</a> - <a href="/tags.html">Tags</a> - <a href="/rss.xml">RSS</a> - <a href="https://creativecommons.org/licenses/by/4.0/">License</a> | README.txt</nav>
      </footer>
  </main>
</body>
</html>